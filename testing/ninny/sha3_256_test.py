# python code for sha3_256
import binascii, hashlib

# 32-byte input (256 bits) as hex
# for random R bits
# msg_hex = "f8f11229044dfea54ddc214aaa439e7ea06b9b4ede8a3e3f6dfef500c9665598"
msg_hex = "8d5296653d9efc336e4c509de356f58420fb64d5b2b4b4038ccca783dd92998e0f8047594efdabfb8a1d6274d9edeb50022687c8025ee1f7b835250c2527ccf2f0d9732169e36e2273204c7f9cf14868ef4c72496e4968935ac0fe16eb237021e4d6a4c88d406940ae2be286ea11df2ef6c8069dd44085cc8aa125d061360e1ecbbbe0382730c68e39a330d2a08ac3c61bd81c49935f652c4c4a65f8c5d8c9e5ff78c654e50776c4edbd5d1897748d6485b8103ebb5e18c90a4ce2fcbb569dd02a42050e47d99f9038c717ef5cc40576722915a7922c92833cacb6d6b852f92522183ac9ff2883a0edf53a8176c72f8f38ec9d21b722c467ab776faf607edeb9f531d7dc24dc7483ce83135b5590722581d41bce9d856c832ca4ca91767ef78c4fb003ed4bca4a073baf400834633c21091baf4bd972d949512ab5aef4ae28ee1b40bdb93fbf233a7e6ef23d19ac04361c542778d2d7e82d23044fb5f9904e1f6c05e684ec491266a22f5b965fa2faf13f94be7828fb0952da94a120453500cec5fc139c9d49d6d0488cdf54727096b580b7f627faa23d6d7de85723e3e1b24089b431fc443f504d12ff8f9ae0ae18bb529ac602a8d231bb4ba3b36ce3cbfb3f0f7588af7c023aef31b78d365a4eaaa1a0c74c5bee84ccc60f8fdbd25a63fc5834c0258a5e8b9dff8eb8ddc1764286f78cca0d80e7d0a75b851c492c46106649153f6fd2a4a4f0201edfea628f7163600852c1157fdaec5fa8739d30903798c955bf8b7b5bcf8978e73899d47b8b6f727673908da9539a9d9611dcd9a78b9ac5eba49636a5141d2870c44de592d38a21e7f7d23030eb0f36cdad724546c89904a7f41770764a3b82183f55fac498ef861151eb2ed49b9aa1eeefa3f90a903fdcd219be175550f14d99d5d7da93feed93479cf7dd8ce79994e453ac0d658ffcc55ad7e344137dd9593b4a7a399cecfc544e1b69a143d8c109ee52a4539d56dc6d2d05f60b1b3fbfd56bb8c0eed29dd719fff08c6e660c997b01018ce87b89eb561201da5bdb7df6df6b2745c5a5d103e9792f0fcec7ee1ea002cd80eb06c8b15e8a2fd09042af29bf31957a0aff91089141fb563796de9cfd4c363cc3df8b4f379804b2ee5fdf308b5ae9422a8245ef6b1a4ba1b773e73f5a559fe97105971c05215bb19074f6114a9f4fd3002af93d387b28f62d8a1d3a02101af18acb03a2aabe25d95b5f6c2c79a919b542ee6fc7f56c0d582c0a7ccf7a87d11a24b56b3c51b49d0d2cf007a4a35cb15754382e35bca557c8e8d2a0a423a478011bd1be05068b22850c06438d16a1b87dd3442ed0e0cc5b7967e071530f078cc5e582ae5cc750e030a6cfd400e9c4811ee32d70fa8417cb542ee6912dfb9f04eacb8e1b308c40bb4e0578dfb70d3b472353842685e2b53e743905b4de051e769c9899017aa83627619c66bc0a9d773bd8e85d0a62feed88d5013888180beb86bcf149981565557894374141558c4a24a7e3ca291d4080d81d5abe1e4cc0f4b7f7804041b8aa5c31f611cda10b447a7deb39e97c2025dd425a2a0ececbdfc0130376ad4d1e73468871dbd7313ce1e1c7902277cd763da144b58019c66ff33d93d4549e111c139266b2d575f524fde8dd8d534d6354671f5ddbb1fb14b8f64efb4d98b8f0afc7"

# verify it's valid hex + check size
msg_bytes = bytes.fromhex(msg_hex)

print("bytes:", len(msg_bytes))           # should be 1184
print("hex chars:", len(msg_hex))       # should be 2368 (because 2 hex chars = 1 byte)

# the continuous hex string (no spaces)
print(msg_hex)

msg = binascii.unhexlify(msg_hex)

sha3_256 = hashlib.sha3_256()
sha3_256.update(msg)

print("SHA3-256 output:", sha3_256.hexdigest())

# for 9472 bits = 1184 bytes (PK)
# shake = hashlib.shake_128()
# shake.update(msg)
# out_5376 = shake.digest(672)
# print("5376-bit output:", out_5376.hex()) 

# Input = random 256 bits
# Output from Verilog permutation : ab907dd90523d3d2168865266fb6acd63cbbd72486267596c3e8cccea24cd0e61c80839ddacecc760d3830416a2db1043576af32c5b246a28d9dab0d1f60d5c0f4d556d520d746cdc9fa0477f0c8985b7ca2e3dfbdd3648a03ab47e113f2c326545a1e1f876b58586201e80b2e0fae52bbe2463132a110e856712049c7cf810d51842b6d2cad0482d641d698b03857bf2fbd74c1dba9c7abee8fc67805ccd8b26006df7f70cf8a054eef72e34b5eb43b30e8d82d76c57fad9b37142ccc83832ce90a958d233dab5c
# Real Output from Verilog :  5cab3d238d950ae92c8383cc2c14379bad7fc5762dd8e8303bb45e4be372ef4e
# Verified, 9/1/26

# Input = PK 9472 bits
# Output from py :       7114d099d253c242dc2d42056253ad2f44883c3bbcf51632c176b9f95bb8938e
# Output from Verilog : 18f36f2f69108b17ce9fdcffd9317d27f57809f86eb7c9e1bcfce945d4f5c694
# Output from verilog (fixed) : python_order = 7114d099d253c242dc2d42056253ad2f44883c3bbcf51632c176b9f95bb8938e
# verified, 10/1/26